(()=>{document.addEventListener("DOMContentLoaded",()=>{let l=(e,a,n)=>{let o=document.getElementById(e);o&&(o.onclick=()=>{let t=document.createElement("div");t.className="modal is-active",a(t,o),t.innerHTML+='<button class="modal-close is-large cancel" aria-label="close"></button>';let c=()=>t.remove();t.querySelectorAll(".cancel").forEach(i=>i.onclick=c),t.querySelector("button.ok").onclick=()=>{t.querySelector("button.ok").classList.add("is-loading"),n(t,c,o)},document.body.appendChild(t)},o.removeAttribute("disabled"))},s=document.getElementById("join-group-button");s&&(s.onclick=()=>{fetch(s.dataset.url,{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken")}}).then(()=>window.location.reload()).catch(e=>alert(e.toString()))},s.removeAttribute("disabled")),l("leave-group-button",(e,a)=>{let n=a.dataset.admin==="true"?"You are an admin in this group. When the last admin leaves, admin status is automatically assigned to someone else. If there are no remaining members, the group will be rejected and removed.":"";e.innerHTML=`
			<div class="modal-background cancel"></div>
			<div class="modal-content box content">
				<p>Really leave this community?</p>
				<p>${n}</p>
				<p class="has-text-right">
					<button class="button is-danger ok">Leave</button>
					<button class="button cancel">Cancel</button>
				</p>
			</div>
		`},(e,a,n)=>{fetch(n.dataset.url,{method:"DELETE",headers:{"X-CSRFToken":getCookie("csrftoken")}}).then(()=>window.location.reload()).catch(o=>alert(o.toString()))}),l("abuse-report-button",e=>{e.innerHTML=`
			<div class="modal-background cancel"></div>
			<div class="modal-content box">
				<div class="content">
					<p>Is this community not complying with the Common Community Guidelines?</p>
					<p>Please describe the problem below:</p>
					<div class="field">
						<textarea class="textarea"></textarea>
					</div>
				</div>
				<p class="has-text-right">
					<button class="button is-primary ok">Report</button>
					<button class="button cancel">Cancel</button>
			</div>
		`},async(e,a,n)=>{let o=e.querySelector("textarea");o.disabled=!0;let t=await fetch(n.dataset.url,{method:"POST",headers:{"X-CSRFToken":getCookie("csrftoken"),"Content-Type":"application/json"},body:JSON.stringify({comment:o.value})});if(t.ok)a();else{let c=document.createElement("div");c.className="notification is-danger",e.querySelector(".ok").remove(),e.querySelector(".content").replaceWith(c),c.textContent=await t.text()}})});})();
